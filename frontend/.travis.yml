matrix:
  include:
  - language: python
    python:
    - '3.6'
    env:
    - IS_DEPLOYABLE=true
    install:
    - pip3 install -r requirements3.txt
    - pip3 install codecov
    script:
    - make test
    after_success:
    - codecov
  - language: node_js
    node_js:
    - '8'
    env:
    - IS_DEPLOYABLE=false
    before_install:
    - cd amundsen_application/static
    install:
    - npm install
    - npm install codecov -g
    script:
    - npm run lint
    - npm run build
    - npm run test
    after_success:
    - codecov
deploy:
  provider: pypi
  user: amundsen-dev
  password:
    secure: QohFWueXLLye2i8KSNRJGqLU4rw8lZJqlByergtyxKpjTuxxMfgl0ejDlu0qZ6qlGiP3kAaS4zAjwDYCNelQmywYODC4UpjarvhfttkltgPH2YDSgFcMxJt5FRXU8Vxwh+AscNo1sZRzXfFPWMRN525mcxDu6CYFCBp2txFW2O9abNHFPU46Jze314tAgmdceHU/Hbs6WT/mBRQRELXoxbw2u2HBVMiHLKCwfio2857xshKGw5Rz1kvt/FVJ1PxwBP57I+6YUfPoy5rOUZWtSuCdBmNlVFk3v1rX/AIap8+PIMACGlUpKhJVRaAGTnSEVzv6bGD6SMOPZ/nVIYl3GssDhRB5uDP2ttilS+Kvbk9BQ/rbcidxxhIGQ8nDx/Auj6PK2e6Hp77N4k4yKxFjz/8cOQhHIKen9LFDXxGfbyoXV5Izf0aYKgvIJxlh3T8Mg42UbyfvztudyjHI1aG1VRF3Qq6Dt0y2yPJYefeAiLqQnCkrDEKTnr6Kxv5lLEi/XTj+tl/pk+OhuVWHyIBGiG+Nb4lZOuW7uo7xqANu6/Ei9plMK7X5ibpPzzRzAWLSpYHOC7dM457XEbgEcWgHzWMC2u1mHoFDlyKcOOqgkgcwmWJZZI4gVVob9uxukdoPN4IABkWhAXC5wQJ3C1eAddRcDAry0bZvFreupsrLIho=
  distributions: sdist bdist_wheel
  on:
    tags: true
    repo: lyft/amundsenfrontendlibrary
    condition: $IS_DEPLOYABLE = true
deploy:
  provider: script
  script: docker login -u amundsendev -p $DOCKER_LOGIN_PASSWORD && make build-push-image
  on:
    branch: master
    tags: true
    repo: lyft/amundsenfrontendlibrary
    condition: $IS_DEPLOYABLE = true

env:
  matrix:
    secure: jvpvfKHbZYDaLgNh/sNPOd2ZU2v4xhrKnPiIKyiHgATTOo1kk+u7H9wsOTjalFwrUi7LtbVgi7XN81bV5toAK/EUBDsNzS7AHJRPnhCLc+jj56JDGH8QcnSeHp3+fDGPQ2rcJUhFZ1r+9NW6V9WQzviuTqUIKY9p7em/Pop2Z8hth6DZuaOkcmozlwMPRGxOZvglEgpD43dVYQraixPJNk+/D3fa26S8be9DdBqE/Cjxs1ZGHQpMxBQSR753/jmt1oCUfS2Bdrh6+/S7oJf7rHrsMWR8TEt1f6HF1wf+0RZUhmY0rCB7PVchcRxz4QusdabQ564pHizIYZ99jd/PGj2wQwYf5hKOgAOukYbxVS/9HPDQOTy9KAcpLmbwXQ6u+GgTF9ZRzhTPY2cvEiavSgUd8Nf5gSyFtw/JDyc8guhxsYSoe44mZHbxNr3VV043YMrQS/5vAiBASwtoC8lzxD1S391EMFcECmmILLne7+bO0h9aQcq+Weijq2W7d/Ec5MTMpHUMZBAgZO6FM9zpY6bTQhfl8PuQViXOfBVZNZZ7n5Cv7XA0vidQS6oPpYBZaw9PZ5nfoFBt5fcZ3kzk/m5JWFQ/+2Ed5ZG7v+fH7Xz/oStkzP/JP2RDnq/5X8VK1L3t3v/r6rM1j8k1DcnaKnbiCDq7W98sA6t1P2xSEAI=
